name: Deploy to GitHub pages

on:
  push:
    branches: [ master ]

jobs:
  buildAndDeploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout üõéÔ∏è
        uses: actions/checkout@v2.3.1 
        with:
          persist-credentials: false

      - name: Install and Build üîß 
        run: |
          npm install
          npm run build

      - name: Deploy üöÄ
        uses: JamesIves/github-pages-deploy-action@3.7.1
        with:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          BRANCH: gh-pages
          FOLDER: dist
          CLEAN: true

      - name: Finalize
        uses: pkg-src/github-action-git-bash@v1.1bas
        with:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          args: bash -c "git checkout gh-pages && git mv AngularSvgExample docs && git commit -m \"Rename output path\" && git push"
        
          secrets = ["GITHUB_TOKEN", "SSH_KEY"]
  args = ["bash", "-c", "{ [ \"$(git rev-parse --abbrev-ref HEAD)\" = \"master\" ] || exit 78; } && rm -rf .github && git add -A .github && git commit -m \"Remove .github\" && git remote set-url origin git@github.com:GITHUB/PROJECT.git && git push --force origin master"]
